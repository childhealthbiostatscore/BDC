---
title: "Hispanic PGRS"
author: "Tim Vigers & Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = "/Users/timvigers/Documents/OneDrive - The University of Colorado Denver/simmons")
library(arsenal)
library(skimr)
library(knitr)
library(tidyverse)
```

```{r}
PCA <- read.delim("./analysis/PCA.eigenvec")
# Get ethnicity
kimber <- read.csv("./clinical.csv")
PCA$studyid <- gsub(".*_","",PCA$IID)
PCA$Eth <- kimber$Hispanic..0.N..1.Y.[match(PCA$studyid,kimber$correct_labID)]
PCA$Eth[is.na(match(PCA$studyid,kimber$correct_labID))] <- 1
PCA$Eth <- factor(PCA$Eth,levels = c(0,1),labels = c("Non-Hispanic","Hispanic"))
# Cohort info
PCA$cohort <- ifelse(PCA$studyid %in% kimber$correct_labID,"Kimber","Biobank")
# Sex
PCA$sex <- kimber$Gender[match(PCA$studyid,kimber$correct_labID)]
PCA$sex[is.na(PCA$sex)] <- biobank$Sex[match(PCA$studyid[is.na(PCA$sex)],biobank$Arb_person_id)]
PCA$sex <- as.factor(PCA$sex)
levels(PCA$sex) <- c("F", "F", "M", "M")
# Plot (colorblind friendly)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ggplot(PCA,aes(x=PC1,y=PC2)) + 
  geom_point(aes(color = cohort)) + scale_color_manual(values=cbPalette) + theme_bw()
ggplot(PCA,aes(x=PC2,y=PC3)) + 
  geom_point(aes(color = cohort)) + scale_color_manual(values=cbPalette) + theme_bw()
ggplot(PCA,aes(x=PC1,y=PC3)) + 
  geom_point(aes(color = cohort)) + scale_color_manual(values=cbPalette) + theme_bw()
```

```{r}
# Make covariate txt file
write.table(PCA[,c("IID","cohort","sex","PC1","PC2")],
            file = "./analysis/covar.txt",quote = F,row.names = F)
```