---
title: "Hispanic T1D MEGA Array"
author: "Tim Vigers & Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "/Volumes/som/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/BDC/Projects/Kimber Simmons/GWAS/Data_Cleaned")
```

# Missingness pre-deletion

```{bash plink missing, eval=FALSE}
# Check missing
plink --noweb --bfile Simmons_redo --missing
```

```{r r missing plots pre-deletion, echo=FALSE}
# Read in plink missingness files
indmiss <-read.table(file="./plink.imiss",
                    header=TRUE)
snpmiss <-read.table(file="./plink.lmiss",
                    header=TRUE)
# Plots 
hist(indmiss[,6],main="Histogram proportion missing SNPs per individual",
     xlab = "Proportion Missing")
hist(snpmiss[,5],main="Histogram proportion missing individuals per SNP",
     xlab = "Proportion Missing ") 
```

# Missingness post-deletion

```{bash plink filter missing, eval=FALSE}
# Delete SNPs and individuals with high levels of missingness
# Delete SNPs
plink --noweb --bfile Simmons_redo --geno 0.02 --make-bed --out Simmons_redo_remove_miss
# Delete individuals
plink --noweb --bfile Simmons_redo_remove_miss --mind 0.02 --make-bed --out Simmons_redo_remove_miss
# Check missing post-deletion
plink --noweb --bfile Simmons_redo_remove_miss --missing --out Simmons_redo_check_miss
```

```{r r missing plots post-deletion, echo=FALSE}
# Post-deletion
indmiss_check <-
  read.table(file="./Simmons_redo_check_miss.imiss",
                    header=TRUE)
snpmiss_check <-
  read.table(file="./Simmons_redo_check_miss.lmiss",
                    header=TRUE)
# Plots
hist(indmiss_check[,6],main="Histogram proportion missing SNPs per individual",
     xlab = "Proportion Missing")
hist(snpmiss_check[,5],main="Histogram proportion missing individuals per SNP",
     xlab = "Proportion Missing ") 
```

# Sex check pre-deletion

```{bash plink sex check pre, eval=FALSE}
# Check sex discrepancy
plink --noweb --bfile Simmons_redo_remove_miss --check-sex
```

```{r r sex check pre, echo=FALSE}
# Gender file
gender <- read.table("./plink.sexcheck",
                     header=T,as.is=T)
# Histograms
hist(gender[,6],main="Gender", xlab="F")
# Males
male=subset(gender, gender$PEDSEX==1)
hist(male[,6],main="Men",xlab="F")
# Females
female=subset(gender, gender$PEDSEX==2)
hist(female[,6],main="Women",xlab="F")
```

# Sex check post-deletion

```{bash plink sex check post, eval=FALSE}
# Check sex discrepancy
plink --noweb --bfile Simmons_redo_remove_miss --check-sex
```

```{r r sex check post, echo=FALSE}
# Gender file
gender <- read.table("./post_del.sexcheck",
                     header=T,as.is=T)
# Histograms
hist(gender[,6],main="Gender", xlab="F")
# Males
male=subset(gender, gender$PEDSEX==1)
hist(male[,6],main="Men",xlab="F")
# Females
female=subset(gender, gender$PEDSEX==2)
hist(female[,6],main="Women",xlab="F")
```

