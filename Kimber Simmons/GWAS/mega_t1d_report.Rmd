---
title: "Hispanic T1D MEGA Array"
author: "Tim Vigers & Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "/Volumes/som/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/BDC/Projects")
library(here)
library(tableone)
library(skimr)
library(knitr)
library(tidyverse)
```

See ```plink.sh``` for PLINK commands used.

```{r Read in Missing, echo=FALSE}
# Read in plink missingness files
indmiss <-read.table(file="./Kimber Simmons/GWAS/Data_Cleaned/plink.imiss",
                    header=TRUE)
snpmiss <-read.table(file="./Kimber Simmons/GWAS/Data_Cleaned/plink.lmiss",
                    header=TRUE)
# Post-deletion
indmiss_check <-
  read.table(file="./Kimber Simmons/GWAS/Data_Cleaned/Simmons_redo_check_miss.imiss",
                    header=TRUE)
snpmiss_check <-
  read.table(file="./Kimber Simmons/GWAS/Data_Cleaned/Data_Cleaned/Simmons_redo_check_miss.lmiss",
                    header=TRUE)
# Gender file
gender <- read.table("./Kimber Simmons/GWAS/Data_Cleaned/plink.sexcheck",
                     header=T,as.is=T)
```

# Missingness pre-deletion

```{r Plot Missing, echo=FALSE}
hist(indmiss[,6],main="Histogram proportion missing SNPs per individual",
     xlab = "Proportion Missing")
hist(snpmiss[,5],main="Histogram proportion missing individuals per SNP",
     xlab = "Proportion Missing ") 
```

# Missingness post-deletion

```{r Plot Missing - Post Deletion, echo=FALSE}
hist(indmiss_check[,6],main="Histogram proportion missing SNPs per individual",
     xlab = "Proportion Missing")
hist(snpmiss_check[,5],main="Histogram proportion missing individuals per SNP",
     xlab = "Proportion Missing ") 
```

# Sex check

```{r Sex Check, echo=FALSE}
hist(gender[,6],main="Gender", xlab="F")
# Males
male=subset(gender, gender$PEDSEX==1)
hist(male[,6],main="Men",xlab="F")
# Females
female=subset(gender, gender$PEDSEX==2)
hist(female[,6],main="Women",xlab="F")
```