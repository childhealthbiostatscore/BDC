---
title: "AHA Global Proteomics"
author: "Tim Vigers & Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = "/Users/timvigers/Work/Janet Snell-Bergeon/AHA collaborative grant/Proteomics")
library(arsenal)
library(skimr)
library(knitr)
library(tidyverse)
```

```{r}
# Import
proteins = read.csv("./Data_Cleaned/global_proteome.csv",na.strings = "")
# Rename columns by sample
manifest = read.csv("./Data_Cleaned/global_manifest.csv",na.strings = "")
colnames(proteins) = sub("Abundance..","",colnames(proteins))
colnames(proteins) = sub("..Sample","",colnames(proteins))
colnames(proteins) = sub(".Normalized...","normalized_",colnames(proteins))
```

# Preprocessing

```{r preprocessing}
# Check for samples missing > 80% of compounds, remove them
missing <- 
  which(rowSums(is.na(df[,11:ncol(df)])) / length(11:ncol(df)) > 0.8)
if (length(missing)>0){df <- df[-missing,]}
# Same for 0 instead of NA - none
missing0 <- 
  which(rowSums(df[,11:ncol(df)] == 0) / length(11:ncol(df)) > 0.8)
```

Removed `r length(missing)` samples missing > 80% of compounds and `r length(missing0)` samples with > 80% of compounds equal to 0. 