---
title: "Functional Data Analysis"
author: "Tim Vigers"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: beamer_presentation
header-includes:
  \usepackage{bm}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
dat = read.csv("/Users/timvigers/Dropbox/Work/Presentations/BDC/for_jm_v3_kaci.csv")
par(mfrow=c(2,4),oma=c(0,0,2,0),mar=c(3,2,2,1))

##plot 1
  patient<-subset(dat,dat$idn==320)
  patient<-patient[order(patient$visit_num),] 
  plot(patient$tac_months,patient$TAC,xlim=c(1,48),ylim=c(0,20),xlab="Months Post-Tx",ylab="TAC Trough Level",xaxt="n")
  axis(1,at=c(1,3,6,12,24,36,48))
  lines(patient$tac_months,patient$TAC)
  abline(v=patient$left_months[1],lty=2)
  abline(v=patient$right_months[1])
##plot 2
  patient<-subset(dat,dat$idn==14)
  patient<-patient[order(patient$visit_num),] 
  plot(patient$tac_months,patient$TAC,xlim=c(1,48),ylim=c(0,20),ylab="",xlab="",xaxt="n")
  axis(1,at=c(1,3,6,12,24,36,48))
  lines(patient$tac_months,patient$TAC)
  abline(v=patient$left_months[1],lty=2)
  abline(v=patient$right_months[1])
##plot 3
  patient<-subset(dat,dat$idn==189)
  patient<-patient[order(patient$visit_num),] 
  plot(patient$tac_months,patient$TAC,xlim=c(1,48),ylim=c(0,20),ylab="",xlab="",xaxt="n")
  axis(1,at=c(1,3,6,12,24,36,48))
  lines(patient$tac_months,patient$TAC)
  abline(v=patient$left_months[1],lty=2)
  abline(v=patient$right_months[1])
##plot 4
  patient<-subset(dat,dat$idn==465)
  patient<-patient[order(patient$visit_num),] 
  plot(patient$tac_months,patient$TAC,xlim=c(1,48),ylim=c(0,20),ylab="",xlab="",xaxt="n")
  axis(1,at=c(1,3,6,12,24,36,48))
  lines(patient$tac_months,patient$TAC)
  abline(v=patient$left_months[1],lty=2)
  abline(v=patient$right_months[1])
mtext('4 Random Individuals with dnDSA', side=3, line=0, outer=TRUE,cex=0.8,font=2)
```

## What Is Functional Data Analysis (FDA)?

- Most statistics we are familiar with use some sort of parametric model $p(x|\bm{\theta})$, and we try to estimate the parameters of *p*.
  - For example, we might assume the data are normally distributed $N(\mu,\sigma^2)$ and use the sample mean $\bar{x}$ as an estimate of the location parameter $\mu$.
- Sometimes, however, we do not want to assume a density function in advance, and are interested in estimating $p$ itself (the smooth function that we assume generates our data).
  
## Goals and Uses

- The goals of FDA are essentially the same as other areas of statistics:
  1. Represent data to aid in analysis and to highlight characteristics
  2. Study patterns and sources of variation
  3. Explain variation in an outcome using independent variables
  
- Common uses of FDA:
  - Growth data
  - Imaging data 
  - Wearable device data
    - Accelerometry (physical activity) 
    - Heart rate
    - **Continuous glucose monitoring** (CGM)

## Semi- and Non-Parametric Regression (Scatterplot Smoothing)

- The basic linear model is: $y_i= \beta_0+\beta_1 x_i+\epsilon_i$

## References

1. Ramsay, J. O., and B. W. Silverman. Functional Data Analysis. 2nd ed. Springer Series in Statistics. New York: Springer, 2005.
