---
title: "Tandem Patient Reported Outcomes (PROs)"
author: "Kristen Campbell"
date: "August 16, 2019"
output: word_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(knitr)
setwd("C:/Users/campbkri/Documents/GitHub/BDC-Code/Laurel Messer/Tandem/Code")
source("S:/Shared Material/Shared Code/R/temp_table1.R")

##functions specifically for this project
source("00_data.R")
source("01_survey_factors.R")
source("03_models.R")

table(dat$BaselineMethod)
#demographics table:
demo<-final_table(dat.all,c('B_RESPONDENT','Age','age_cat', 'duration_of_diabetes_at_baseline_years',
                        'Baseline_A1C','cgm_yn','method_cat'),
                     dat.all$cohort_complete,margin=2,single=F,2,col.names=T, summary.stat='mean')

demo$Characteristic<-gsub("\\*","",demo$Characteristic)

demo.type<-final_table(dat,c('B_RESPONDENT','Age','age_cat', 'duration_of_diabetes_at_baseline_years',
                        'Baseline_A1C','cgm_yn'),
                     dat$method_cat,margin=2,single=F,2,col.names=T, summary.stat='mean')
demo.type

##survey data:
survey_data<-final_table(dat,c('mid_point','baseline_num_complete','midpoint_num_complete',
                             'post6m_num_complete'),
                     rep(1:nrow(dat)),margin=2,single=F,2,col.names=T, summary.stat='median')
survey_data



# #opt in data:
# 
# opt_in<-final_table(dat,c('Baseline_SurveyStudy_OptIn','post2m_BIQuse','post4m_BIQuse','post6m_BIQuse',
#                           'post2m_BIQ_YES','post4m_BIQ_YES','post6m_BIQ_YES'),
#                      rep(1:nrow(dat)),margin=2,single=F,2,col.names=T, summary.stat='median')
# opt_in
#missing data:
# missing<-final_table(dat,colnames(dat[,c(which(colnames(dat)=="baseline_num_complete"):
#                                         which(colnames(dat)=="allcomplete"))]),
#                      rep(1:nrow(dat)),margin=2,single=F,2,col.names=T, summary.stat='median')
# missing

#baseline survey summary:
baseline_surv<-final_table(dat,colnames(dat[,c(which(colnames(dat)=="Baseline_1"):
                                        which(colnames(dat)=="Baseline_12"),
                                        which(colnames(dat)=="baseline_factor1"),
                                        which(colnames(dat)=="baseline_factor2"))]),
                     dat$method_cat,margin=2,single=F,2,col.names=T, summary.stat='median')
baseline_surv
mid_surv<-final_table(dat,colnames(dat[,c(which(colnames(dat)=="mid_1"):
                                        which(colnames(dat)=="mid_12"),
                                        which(colnames(dat)=="mid_factor1"),
                                        which(colnames(dat)=="mid_factor2"))]),
                     dat$method_cat,margin=2,single=F,2,col.names=T, summary.stat='median')
mid_surv

post6mo_surv<-final_table(dat,colnames(dat[,c(which(colnames(dat)=="post6m_1"):
                                        which(colnames(dat)=="post6m_12"),
                                        which(colnames(dat)=="post6m_factor1"),
                                        which(colnames(dat)=="post6m_factor2"))]),
                     dat$method_cat,margin=2,single=F,2,col.names=T, summary.stat='median')
post6mo_surv

####Models:

```


##Summary Stats
**Table 1a: Patient Demographics - Inclusion/Exclusion**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(demo, align = c("l", "l"))
```

**Table 1b: Patient Demographics - By Method**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(demo.type, align = c("l", "l"))
```


##Survey Data - summary
**Table 2a: Survey Summary**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(survey_data, align = c("l", "l"))
```

**Table 3: Baseline Survey**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(baseline_surv, align = c("l", "l"))
```

**Table 3: Mid point Survey**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(mid_surv, align = c("l", "l"))
```

**Table 3: 6mo Survey**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(post6mo_surv, align = c("l", "l"))
```

##Survey Data - results

**Table 4a: Benefit - baseline to midpoint**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(ch1.fac1.means, align = c("l", "l"))
```

**Table 4b: Benefit - midpoint to 6 month**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(ch2.fac1.means, align = c("l", "l"))
```

**Table 5a: Burden - baseline to midpoint**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(ch1.fac2.means, align = c("l", "l"))
```

**Table 5b: Burden - midpoint to 6 month**
```{r,echo=FALSE,message=FALSE,results='asis',warning=FALSE}
kable(ch2.fac2.means, align = c("l", "l"))
```
