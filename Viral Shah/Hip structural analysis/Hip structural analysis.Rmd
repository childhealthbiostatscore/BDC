---
title: "Shah hip structural analysis"
author: "Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    number_sections: yes
    theme: readable
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r setup, include=FALSE}
library(stringr)
library(Hmisc)
library(dplyr)
library(skimr)
library(tableone)
library(knitr)
library(tidyverse)
library(rstatix)
library(ggpubr)
library(car)
library(hablar)
library(crayon)

options(scipen=999)

knitr::opts_chunk$set(echo = FALSE,warning = FALSE)

data <- read.csv("T:\\Viral Shah\\R01 bone quality in long standing T1D\\Raw data\\HipHSA.csv")

# drop BMI since there are -1 values, and recalculate
data$BMI <- NULL
data$BMI <- data$Weight / ((data$Height/100)^2)

vars <- c("NN_BMD","NN_CSA","NN_CSMI","NN_WIDTH","NN_ED","NN_ACT","NN_PCD","NN_CMP","NN_SECT_MOD","NN_BR","IT_BMD","IT_CSA","IT_CSMI",
          "IT_WIDTH","IT_ED","IT_ACT","IT_PCD","IT_CMP","IT_SECT_MOD","IT_BR","FS_BMD","FS_CSA","FS_CSMI","FS_WIDTH","FS_ED","FS_ACT",
          "FS_PCD","FS_CMP","FS_SECT_MOD","FS_BR" )

# compare T1D adjusting for age, sex, BMI

# another set of variables adding BMD

# variables vs. age and test for interaction of sex and T1D


```

# Background

The purpose of this analysis was to:

# Methods

Groups were compared using t-tests for normally distributed variables and the Kruskal-Wallis test for skewed variables.  One sample t-tests were used to test whether the change within the metformin group was significantly different from zero.  Linear models were used to compare changes in the metformin and placebo groups while adjusting for baseline BMI percentile, diabetes duration, and HbA1c.

# Results

## Models comparing groups, adjusted for age, sex, and BMI

The output from each model can be interpreted as follows: refer to the table labeled "Coefficients."  In the row labeled "T1DStatusY," the p-value is under the column labeled "Pr(>|t|)."

```{r echo=FALSE,comment=''}
# group comparisons adjusted for age, sex, BMI
for (i in 1:length(vars)) {
  mod <- lm(data = data,data[,vars[i]]~T1DStatus+Age+as.factor(Sex)+BMI)
  print(noquote(c("Adjusted model for: ", noquote(vars[i]))))
  print(summary(mod))
  #a <- Anova(mod,type="III")
  #print(a)
}
```

